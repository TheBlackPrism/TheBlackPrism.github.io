<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-154262640-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-154262640-1');
    </script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>The Black Prism</title>
    <meta name="description" content="some very important website">
    <meta name="author" content="TheBlackPrism">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="./css/styles.css">
    <link href='https://fonts.googleapis.com/css?family=Nunito' rel='stylesheet' type='text/css'>

    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <meta property="og:title" content="The Black Prism" />
    <meta property="og:url" content="https://blackprism.tk" />
    <meta property="og:image" content="https://blackprism.tk/images/Black-Prism_Logo_V05_Black.png" />
</head>

<body>
    <!-- Preloader -->
    <div class="preloader d-flex align-items-center justify-content-center">
        <div class="lds-ellipsis">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>


    <!-- ##### Header Area Start ##### -->
    <!-- ##### Header Area Start ##### -->
    <header class="header-area">
        <!-- Navbar Area -->
        <div class="newsbox-main-menu">
            <div class="classy-nav-container breakpoint-off">
                <div class="container-fluid">
                    <!-- Menu -->
                    <nav class="classy-navbar justify-content-between" id="newsboxNav">

                        <!-- Nav brand -->
                        <a href="index.html" class="nav-brand">The Black Prism</a>
                        <!-- Navbar Toggler -->
                        <div class="classy-navbar-toggler">
                            <span class="navbarToggler"><span></span><span></span><span></span></span>
                        </div>

                        <!-- Menu -->
                        <div class="classy-menu">

                            <!-- Close Button -->
                            <div class="classycloseIcon">
                                <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                            </div>

                            <!-- Nav Start -->
                            <div class="classynav">
                                <ul>
                                    <li><a href="index.html">Home</a></li>
                                    <li><a href="blogs.html">Blog</a>
                                        <ul class="dropdown">
                                            <li><a href="blogs.html">All Blogs</a></li>
                                            <li><a href="2048-AI.html">Artificial Intelligence</a></li>
                                            <li><a href="dragnet.html">CSP & Datalog</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="photos.html">Photos</a>
                                        <ul class="dropdown">
                                            <li><a href="photos.html">All Photos</a></li>
                                            <li><a href="africa.html">Africa</a></li>
                                            <li><a href="mountains.html">Mountains</a></li>
                                            <li><a href="diverse.html">Diverse</a></li>
                                        </ul>
                                    </li>
                                    <li><a href="https://github.com/TheBlackPrism.html">Github</a></li>
                                    <li><a href="about.html">About</a></li>
                                </ul>
                            </div>
                            <!-- Nav End -->
                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- ##### Header Area End ##### -->

    <!-- ##### Hero Area Start ##### -->
    <div class="section-padding-200">
        <div class="container blogpost">
            <h2>Artificial Intelligence for 2048</h2>
            <h4 class="subtitle">An approach to beat 2048 with AI</h4>
            <h5>By Jennifer Schürch & Yves Lütjens</h5>
            <p>The game 2048 is a hard game to beat. As there are many random variables during play, one has a hard time to implement a good algorithm for it.
                We started off by implemented a heuristic algorithm and set the aim that it can reach 10'000 points in average.<br>
            </p>
            <h4>Heuristic</h4>
            <p>Our first approach consisted of creating an algorithm which moved alternately down and right and as soon as he was stuck trying to find if the
                bottom row or the lefthand row was full and move in that direction. The idea behind this "Pretty Good" algorithm was to keep the highest tile in the bottom right corner.
                After a short time we realised that this strategy will not bear fruits as it's average score was around 4'000 points, so we discarded our algorithm and started over.<br>
                This time we made the "Check Score" algorithm which chose the turn that would lead to the greatest score, ignoring the random tile spawn. The scoring itself was a combination of different experiences that we obtained from the previous version.
                On one hand it gave penalties to moves that would lead to badly shaped boards and on the otherhand it gave bonus for same neighbours.<br>
                Built on the Check Score algorithm we build the "Hierarchical" algorithm which also did look two steps in the future in every possible direction (still ignoring the random tile spawn) and assessed the board at that stage. We valued the board
                by a score which was strongly depending on the position of the tiles. A better positioning of a tile lead to a higher factor. This factor will then be multiplied the value of the tile.
                A good position was the closeness to the bottom right corner, and the tile in the corner itself got an additional bonus,
                to force the algorithm to keep the highest value there. The board score distribution for this version looked like this:
            </p>
            <figure>
                <img class="article-image-rect" src="images/blogs/ai/board_bonus_heuristic.jpg" alt="Bonus distribution heuristic">
                <figcaption>Bonus distribution Hierarchical</figcaption>
            </figure>
            <p>These improvements got us way closer to our aim, overall the algorithm scored an average of 7'000 points.<br>
                We further improved it by giving a neighbourbonus which we had in the Check Score algorithm, for tiles of the same value and weighted empty tiles too, so the algorithm had more interest in merging tiles.
                This small tweaks finally pushed our algorithm slightly over the 10'000 points threshold.<br>
                The following graphs show how the different heuristic algorithms did perform over 200 games and how they perform against the given random agent.
            </p>
            <table>
                <caption>Comparison of the implemented heuristics</caption>
                <tbody>
                    <tr>
                        <th>Algorithm Name</th>
                        <th>Highscore</th>
                        <th>Average Score</th>
                        <th>Highest Tile</th>
                        <th>Time Per Move [s]</th>
                    </tr>
                    <tr>
                        <td>Random Agent</td>
                        <td>2'960</td>
                        <td>1'052</td>
                        <td>256</td>
                        <td>0.010664</td>
                    </tr>
                    <tr>
                        <td>Pretty Good</td>
                        <td>8'012</td>
                        <td>4'121</td>
                        <td>512</td>
                        <td>0.003739</td>
                    </tr>
                    <tr>
                        <td>Check Score</td>
                        <td>17'080</td>
                        <td>6'975</td>
                        <td>1024</td>
                        <td>0.009889</td>
                    </tr>
                    <tr>
                        <td>Hierarchical Rating</td>
                        <td>62'800</td>
                        <td>14'752</td>
                        <td>4096</td>
                        <td>0.008578</td>
                    </tr>
                </tbody>
            </table>
            <figure>
                <div class="single-slide">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-6">
                                <img class="article-statistic" src="images/blogs/ai/scores_heuristicai.png" alt="scores heuristic ai">
                                <figcaption>Distribution of the heuristics score over 200 games</figcaption>
                            </div>
                            <div class="col-md-6">
                                <img class="article-statistic" src="images/blogs/ai/highest_tiles_reached_heuristicai.png" alt="highest reached tiles heuristic ai">
                                <figcaption>Distribution of the highest reached tiles of the heuristics over 200 games</figcaption>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
            <h4>Expectimax</h4>
            <p>As 2048 contains a random factor in regard of the randomly spawned 2 or 4 value tile, Expectimax is the most obvious approach to implement an AI.
                We used the Hierarchicals heuristics score function (called Heuristic in the following) to value the board, as well as an adaptive depth going from depth one to depth three depending on the number of empty tiles.
                This allowed us to speed up the early phase of the game, as depth 3 with our score function needed up to 20 seconds for a move, depending on the number of empty tiles after a move.
                As we urged for more speed, we also implemented multiprocessing into our AI that created a process for each top level move, in order to speed it up further.
                Thanks to the two mentioned measurements we achieved an average time per move of under one second.
                Overall the first iteration of our AI did alot better than the heuristic, it regularly won the game and the average score increased to 30'000 points.
                It was a good first step but we wanted to do better!<br>
                The next thing we tried was implementing a bonus if the neighbour was half as big, so that the AI can merge more smoothly. In contrary to what we expected,
                this measurement destroyed the algorithm and scored lower than the heuristic. We came up with the idea to distribute the factors like a snake and give the corner a hefty bonus, according to the following image:
            </p>
            <figure>
                <img class="article-image-rect" src="images/blogs/ai/board_bonus_searchai_heuristic.jpg" alt="Bonus distribution second iteration">
                <figcaption>Bonus distribution Improved Heuristic</figcaption>
            </figure>
            <p>The results showed further improvement in the average score up to 44'000 points. The problem was that the algorithm still did not stack the tiles in a perfect descending order.
                Sometimes small numbers where caught in the bottom left corner which disturbed the system and lead to big problems after the 4096 tile has been reached. Therefore we came up with the Snakey variation of the heuristic
                score system. In the Snakey variation we generated an array of big numbers with great distances between each other and in a descending order that would force the AI to fill up all the ranks in the bottom rows.
                This approach finally was the breakthrough we where looking for!<br>
                With an average score of 90'000 points it exceeded all previous implementations we made by far.
                Furthermore this variant was alot faster than previous iterations as it only needs to make one
                matrix multiplication instead of two for loops and multiple if statements.<br>
                We tested out multiple other distributions, which we thought could work well with the same system as the Snakey.
                One was a diagonal decreasing distribution of the bonuses, another one was squares, and the last one was Snakey+ which also had a neighbourbonus implemented.
                At the end Snakey still was the most succesfull variation we created and if we wanted to improve it it just got worse.
                The score distribution for the different versions looked as follows:
            </p>
            <figure>
                <div class="single-slide">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-4">
                                <img class="article-image-rect" src="images/blogs/ai/board_bonus_searchai_snakey.jpg" alt="Bonus distribution Snakey">
                                <figcaption>Bonus distribution Snakey</figcaption>
                            </div>
                            <div class="col-md-4">
                                <img class="article-image-rect" src="images/blogs/ai/board_bonus_searchai_diagonaled.jpg" alt="Bonus distribution Snakey">
                                <figcaption>Bonus distribution Diagonal</figcaption>
                            </div>
                            <div class="col-md-4">
                                <img class="article-image-rect" src="images/blogs/ai/board_bonus_searchai_squared.jpg" alt="Bonus distribution Snakey">
                                <figcaption>Bonus distribution Square</figcaption>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
            <p>
            </p>

            <h4>Conclusion</h4>
            <p>In the following table we listed the performance of each expectimax scoring function we developed, to compare them against each other.
            </p>
            <table>
                <caption>Comparison of the implemented expectimax scoring functions</caption>
                <tr>
                    <th>Algorithm Name</th>
                    <th>Highscore</th>
                    <th>Average Score</th>
                    <th>Highest Tile</th>
                    <th>Time Per Move [s]</th>
                </tr>
                <tr>
                    <td>Snakey</td>
                    <td>167'888</td>
                    <td>90'813</td>
                    <td>8192</td>
                    <td>0.58130573</td>
                </tr>
                <tr>
                    <td>Snakey+</td>
                    <td>113'180</td>
                    <td>68'555</td>
                    <td>8192</td>
                    <td>1.30097970</td>
                </tr>
                <tr>
                    <td>Diagonal</td>
                    <td>132'996</td>
                    <td>65'321</td>
                    <td>8192</td>
                    <td>0.54674995</td>
                </tr>
                <tr>
                    <td>Heuristic</td>
                    <td>112'776</td>
                    <td>44'194</td>
                    <td>8192</td>
                    <td>0.15212381</td>
                </tr>
                <tr>
                    <td>Square</td>
                    <td>36'772</td>
                    <td>19'658</td>
                    <td>2048</td>
                    <td>0.08806930</td>
                </tr>
            </table>

            <p>The following two graphs show how the score and the tiles have been distributed over 20 games. As one can see, is the Snakey scoring function
                mostly in the range between 60'000 to 80'000 points, which means that he often fails just before merging to the 8192. Whereas the Diagonal scoring function seems to have
                less problems merging to the 8192 tile when it even comes as far as the 4096 tile. This leads to the conclusion that in the Diagonal function the distribution of tiles
                seems to be better when the board is loaded with high tiles.
                A next step could be to combine the Snakey and Diagonal function, that the Snakey handles the part until the 4096 tile and then the Diagonal function takes over to reach an even higher score.
            </p>
            <figure>
                <div class="single-slide">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-6">
                                <img class="article-statistic" src="images/blogs/ai/scores.png" alt="score distribution">
                                <figcaption>Distribution of the score over 20 games</figcaption>
                            </div>
                            <div class="col-md-6">
                                <img class="article-statistic" src="images/blogs/ai/highest_tiles_reached.png" alt="highest reached tiles">
                                <figcaption>Distribution of the highest reached tiles over 20 games</figcaption>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>
            <p>As a last step we analysed the speed of our AI and how much multiprocessing speeded the calculation up for different depths.
                We started always from the same board as seen on the graphic below and made three moves with every variation.
                The variations reached from depth one to depth five and once with multiprocessing enabled and once without.
                We calculated the average time per move and compared them to each other.</br>
                In conclusion we saw that multiprocessing is already a bit faster at depth one and nearly double as fast at depth two.
                As expected the performance boost increased quickly and at depth five multiprocessing was already four times faster than singleproccessing.
            </p>
            <figure>
                <div class="single-slide">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-4">
                                <img class="article-statistic" src="images/blogs/ai/time_measure_starting_point.png" alt="starting point time measurement">
                                <figcaption>Startingboard of the time measurement</figcaption>
                            </div>
                            <div class="col-md-4">
                                <img class="article-statistic" src="images/blogs/ai/time_per_move_per_depths.png" alt="average time per move per depths">
                            </div>
                            <div class="col-md-4">
                                <table class="article-statistic">
                                    <tr>
                                        <th>Depth</th>
                                        <th>Singleprocess&nbsp;[s]</th>
                                        <th>Multiprocess&nbsp;[s]</th>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td>0.010971</td>
                                        <td>0.008644</td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td>0.067817</td>
                                        <td>0.040891</td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td>2.558497</td>
                                        <td>0.620329</td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td>48.070847</td>
                                        <td>24.369725</td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td>1641.396178</td>
                                        <td>416.629117</td>
                                    </tr>
                                </table>
                                <figcaption>Average times per move per depths</figcaption>
                            </div>
                        </div>
                    </div>
                </div>
            </figure>

            <div id="disqus_thread"></div>
            <script>
                /**
                 *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                 *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
                /**
                var disqus_config = function () {
                this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                };
                **/
                (function() { // DON'T EDIT BELOW THIS LINE
                    var d = document,
                        s = d.createElement('script');
                    s.src = 'https://blackprism.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

        </div>
    </div>


    <!-- ##### Footer Area Start ##### -->
    <footer class="footer-area">
        <!-- Footer Logo -->
        <div class="footer-logo mb-100">
            <a href="index.html">The Black Prism</a>
        </div>
    </footer>
    <!-- ##### Footer Area Start ##### -->

    <div id="particles-js"></div>
    <!-- ##### All Javascript Script ##### -->
    <!-- jQuery-2.2.4 js -->
    <script src="js/jquery/jquery-2.2.4.min.js"></script>
    <!-- Popper js -->
    <script src="js/bootstrap/popper.min.js"></script>
    <!-- Bootstrap js -->
    <script src="js/bootstrap/bootstrap.min.js"></script>
    <!-- All Plugins js -->
    <script src="js/plugins/plugins.js"></script>
    <!-- Active js -->
    <script src="js/active.js"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="js/main.js"></script>
</body>

</html>
